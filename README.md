Split_transcripts
=================
This script reads in a gtf file (e.g. from Cuffmerge), and splits it into
non-overlapping genes, with one transcript per gene according to a second
(reference) gff. This might be useful if a downstream program (e.g. DEXSeq)
requires each gene to be separate and not overlapping with its neighbours.

Arguments and input files
-------------------------
**RNA-seq data** (-i, --input GTF_FILE): the gtf parser is designed for use with
Cuffmerge gtf files. Hence, the canonical usage is to use the Tuxedo pipeline
(map reads with [Tophat](http://tophat.cbcb.umd.edu/), create gene models with
[Cufflinks](http://cufflinks.cbcb.umd.edu/), and merge samples with
[Cuffmerge](http://cufflinks.cbcb.umd.edu/)).

**Reference gene models** (-g, --ref_gff GFF_FILE): the gff parser is designed
for use with gff files from [eupathdb](http://eupathdb.org). It only parses
features marked as "CDS", since UTR information is not available for all genes.

**Pileup file** (-p, --pileup PILEUP_FILE): optional. Used to determine the
position of the split. Pileup files can be generated by using samtools to merge
multiple bam files (if necessary), then running samtools mpileup.
e.g.

    samtools merge merged.bam in1.bam in2.bam in3.bam
    samtools mpileup merged.bam > merged.pileup
The split will be determined by the following conditions, in order
of precedence.
1. Minimum read depth as reported from pileup file.
2. If there are multiple minima, use the one closest to the middle of the gap.
3. If no pileup file is specified, just split in the middle of the gap.

**Split position** (-s, --split_position PERCENT): optional. The minimum read
depth may not be the correct place to split transcripts, so instead, we can
restrict potential split coordinates to the central part of the reference
intergenic gap. This argument specifies the central percent of the gap that is
acceptable for the split.

Output
------
Gene IDs from the reference gff file are written to the transcripts, if they
cover a single gene. In other cases, the nearest gene is recorded. e.g. for
intergenic transcripts, "after_GENE_ID" or "before_GENE_ID"; and for transcripts
that lie before the first gene or after the last gene, "before_first_GENE_ID" or
"after_last_GENE_ID". If there are no genes on the reference contig, the gene ID
is "No_genes_on_ref_contig".

If transcripts cover multiple genes, then the transcripts will be renamed to
"TRANSCRIPT_ID:a", "TRANSCRIPT_ID:b", etc.

These strings can be easily modified from the code.